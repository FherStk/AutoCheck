/*
    Copyright © 2022 Fernando Porrino Serrano
    Third party software licenses can be found at /docs/credits/credits.md

    This file is part of AutoCheck.

    AutoCheck is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    AutoCheck is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with AutoCheck.  If not, see <https://www.gnu.org/licenses/>.
*/

using System.IO;
using NUnit.Framework;

namespace AutoCheck.Test
{    
    [Parallelizable(ParallelScope.All)]    
    public class RealCss3 : Test
    { 
        public RealCss3(): base("script/real"){
        }        

        [Test, Category("FullScriptCss3"), Category("Real"), Category("Local")]
        public void Real_CSS3_SCRIPT_SINGLE_1()
        {           
            //Some errors  
            var s = new AutoCheck.Core.Script(GetSampleFile("real_css3_single_1.yaml"));                        
            Assert.AreEqual("Running script 'DAM - M04 (UF1): CSS3 Assignment' (v1.0.0.2):\r\nRunning on single mode for 'Student Name 1':\r\n   Question 1 [3 points] - Checking index.html:\r\n      Looking for index.html... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 1.1 [1 point] - Validating inline CSS:\r\n         Checking for inline CSS entries... OK\r\n\r\n      Question 1.2 [1 point] - Validating DIVs:\r\n         Checking the amount of divs... OK\r\n\r\n      Question 1.3 [1 point] - Validating video:\r\n         Checking amount of video entries... ERROR:\n            -Expected -> >=1; Found -> 0\r\n\r\n   Question 2 [14 points] - Checking index.css:\r\n      Looking for index.css... OK\r\n      Loading index.css... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 2.1 [1 point] - Validating font property:\r\n         Checking if the font property has been created... OK\r\n         Checking if the font property has been applied... OK\r\n\r\n      Question 2.2 [1 point] - Validating border property:\r\n         Checking if the border property has been created... OK\r\n         Checking if the border property has been applied... OK\r\n\r\n      Question 2.3 [1 point] - Validating text property:\r\n         Checking if the text property has been created... OK\r\n         Checking if the text property has been applied... OK\r\n\r\n      Question 2.4 [1 point] - Validating color property:\r\n         Checking if the color property has been created... OK\r\n         Checking if the color property has been applied... OK\r\n\r\n      Question 2.5 [1 point] - Validating background property:\r\n         Checking if the background property has been created... OK\r\n         Checking if the background property has been applied... OK\r\n\r\n      Question 2.6 [1 point] - Validating position:absolute property:\r\n         Checking if the position:absolute property has been created... OK\r\n         Checking if the position:absolute property has been applied... OK\r\n\r\n      Question 2.7 [1 point] - Validating position:relative property:\r\n         Checking if the position:relative property has been created... OK\r\n         Checking if the position:relative property has been applied... OK\r\n\r\n      Question 2.8 [1 point] - Validating clear property:\r\n         Checking if the clear property has been created... OK\r\n         Checking if the clear property has been applied... OK\r\n\r\n      Question 2.9 [1 point] - Validating clear property:\r\n         Checking if the width property has been created... OK\r\n         Checking if the width property has been applied... OK\r\n\r\n      Question 2.10 [1 point] - Validating height property:\r\n         Checking if the height property has been created... OK\r\n         Checking if the height property has been applied... OK\r\n\r\n      Question 2.11 [1 point] - Validating margin property:\r\n         Checking if the margin property has been created... OK\r\n         Checking if the margin property has been applied... OK\r\n\r\n      Question 2.12 [1 point] - Validating padding property:\r\n         Checking if the padding property has been created... OK\r\n         Checking if the padding property has been applied... OK\r\n\r\n      Question 2.13 [1 point] - Validating list property:\r\n         Checking if the list property has been created... OK\r\n         Checking if the list property has been applied... OK\r\n\r\n      Question 2.14 [1 point] - Validating (top | right | bottom | left) property:\r\n         Checking if the (top | right | bottom | left) property has been created... OK\r\n         Checking if the (top | right | bottom | left) property has been applied... OK\r\n\r\n   TOTAL SCORE: 9.41 / 10", s.Output.ToString());
        }       

        [Test, Category("FullScriptCss3"), Category("Real"), Category("Local")]
        public void Real_CSS3_SCRIPT_SINGLE_2()
        {             
            //Uses more than one CSS file with no errors
            var s = new AutoCheck.Core.Script(GetSampleFile("real_css3_single_2.yaml"));
            Assert.AreEqual("Running script 'DAM - M04 (UF1): CSS3 Assignment' (v1.0.0.2):\r\nRunning on single mode for 'Student Name 2':\r\n   Question 1 [3 points] - Checking index.html:\r\n      Looking for index.html... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 1.1 [1 point] - Validating inline CSS:\r\n         Checking for inline CSS entries... OK\r\n\r\n      Question 1.2 [1 point] - Validating DIVs:\r\n         Checking the amount of divs... OK\r\n\r\n      Question 1.3 [1 point] - Validating video:\r\n         Checking amount of video entries... OK\r\n\r\n   Question 2 [14 points] - Checking index.css:\r\n      Looking for index.css... OK\r\n      Loading index.css... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 2.1 [1 point] - Validating font property:\r\n         Checking if the font property has been created... OK\r\n         Checking if the font property has been applied... OK\r\n\r\n      Question 2.2 [1 point] - Validating border property:\r\n         Checking if the border property has been created... OK\r\n         Checking if the border property has been applied... OK\r\n\r\n      Question 2.3 [1 point] - Validating text property:\r\n         Checking if the text property has been created... OK\r\n         Checking if the text property has been applied... OK\r\n\r\n      Question 2.4 [1 point] - Validating color property:\r\n         Checking if the color property has been created... OK\r\n         Checking if the color property has been applied... OK\r\n\r\n      Question 2.5 [1 point] - Validating background property:\r\n         Checking if the background property has been created... OK\r\n         Checking if the background property has been applied... OK\r\n\r\n      Question 2.6 [1 point] - Validating position:absolute property:\r\n         Checking if the position:absolute property has been created... OK\r\n         Checking if the position:absolute property has been applied... OK\r\n\r\n      Question 2.7 [1 point] - Validating position:relative property:\r\n         Checking if the position:relative property has been created... OK\r\n         Checking if the position:relative property has been applied... OK\r\n\r\n      Question 2.8 [1 point] - Validating clear property:\r\n         Checking if the clear property has been created... OK\r\n         Checking if the clear property has been applied... OK\r\n\r\n      Question 2.9 [1 point] - Validating clear property:\r\n         Checking if the width property has been created... OK\r\n         Checking if the width property has been applied... OK\r\n\r\n      Question 2.10 [1 point] - Validating height property:\r\n         Checking if the height property has been created... OK\r\n         Checking if the height property has been applied... OK\r\n\r\n      Question 2.11 [1 point] - Validating margin property:\r\n         Checking if the margin property has been created... OK\r\n         Checking if the margin property has been applied... OK\r\n\r\n      Question 2.12 [1 point] - Validating padding property:\r\n         Checking if the padding property has been created... OK\r\n         Checking if the padding property has been applied... OK\r\n\r\n      Question 2.13 [1 point] - Validating list property:\r\n         Checking if the list property has been created... OK\r\n         Checking if the list property has been applied... OK\r\n\r\n      Question 2.14 [1 point] - Validating (top | right | bottom | left) property:\r\n         Checking if the (top | right | bottom | left) property has been created... OK\r\n         Checking if the (top | right | bottom | left) property has been applied... OK\r\n\r\n   TOTAL SCORE: 10 / 10", s.Output.ToString());
        }

        [Test, Category("FullScriptCss3"), Category("Real"), Category("Local")]
        public void Real_CSS3_SCRIPT_SINGLE_3()
        {        
            //Everything is wrong
            var s = new AutoCheck.Core.Script(GetSampleFile("real_css3_single_3.yaml"));
            Assert.AreEqual("Running script 'DAM - M04 (UF1): CSS3 Assignment' (v1.0.0.2):\r\nRunning on single mode for 'Student Name 3':\r\n   Question 1 [3 points] - Checking index.html:\r\n      Looking for index.html... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... ERROR:\n         -Element head is missing a required instance of child element title.tyle>\n             <h1>La MusContent model for element head:If the document is an iframesrcdoc document or if title information is available from a higher-level protocol: Zero or more elements of metadata content, of which no more than one is a title element and no more than one is a base element.Otherwise: One or more elements of metadata content, of which exactly one is a title element and no more than one is a base element.\r\n\r\n   Question 2 [14 points] - Checking index.css:\r\n      Looking for index.css... OK\r\n      Loading index.css... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... ERROR:\n         -Value Error :  padding (nullbox.html#propdef-padding)\n         “,” is an incorrect operator :\r\n\r\n   TOTAL SCORE: 0 / 10", s.Output.ToString());
        }

        [Test, Category("FullScriptCss3"), Category("Real"), Category("Local")]
        public void Real_CSS3_SCRIPT_BATCH()
        {             
            var s = new AutoCheck.Core.Script(GetSampleFile("real_css3_batch.yaml"));
            var expected = "Running script DAM - M04 (UF1): CSS3 Assignment (v1.0.0.2):\r\nRunning on batch mode for Student Name 1:\r\n   Question 1 [3 points] - Checking index.html:\r\n      Looking for index.html... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 1.1 [1 point] - Validating inline CSS:\r\n         Checking for inline CSS entries... OK\r\n\r\n      Question 1.2 [1 point] - Validating DIVs:\r\n         Checking the amount of divs... OK\r\n\r\n      Question 1.3 [1 point] - Validating video:\r\n         Checking amount of video entries... ERROR:\n            -Expected -> >=1; Found -> 0\r\n\r\n   Question 2 [14 points] - Checking index.css:\r\n      Looking for index.css... OK\r\n      Loading index.css... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 2.1 [1 point] - Validating font property:\r\n         Checking if the font property has been created... OK\r\n         Checking if the font property has been applied... OK\r\n\r\n      Question 2.2 [1 point] - Validating border property:\r\n         Checking if the border property has been created... OK\r\n         Checking if the border property has been applied... OK\r\n\r\n      Question 2.3 [1 point] - Validating text property:\r\n         Checking if the text property has been created... OK\r\n         Checking if the text property has been applied... OK\r\n\r\n      Question 2.4 [1 point] - Validating color property:\r\n         Checking if the color property has been created... OK\r\n         Checking if the color property has been applied... OK\r\n\r\n      Question 2.5 [1 point] - Validating background property:\r\n         Checking if the background property has been created... OK\r\n         Checking if the background property has been applied... OK\r\n\r\n      Question 2.6 [1 point] - Validating position:absolute property:\r\n         Checking if the position:absolute property has been created... OK\r\n         Checking if the position:absolute property has been applied... OK\r\n\r\n      Question 2.7 [1 point] - Validating position:relative property:\r\n         Checking if the position:relative property has been created... OK\r\n         Checking if the position:relative property has been applied... OK\r\n\r\n      Question 2.8 [1 point] - Validating clear property:\r\n         Checking if the clear property has been created... OK\r\n         Checking if the clear property has been applied... OK\r\n\r\n      Question 2.9 [1 point] - Validating clear property:\r\n         Checking if the width property has been created... OK\r\n         Checking if the width property has been applied... OK\r\n\r\n      Question 2.10 [1 point] - Validating height property:\r\n         Checking if the height property has been created... OK\r\n         Checking if the height property has been applied... OK\r\n\r\n      Question 2.11 [1 point] - Validating margin property:\r\n         Checking if the margin property has been created... OK\r\n         Checking if the margin property has been applied... OK\r\n\r\n      Question 2.12 [1 point] - Validating padding property:\r\n         Checking if the padding property has been created... OK\r\n         Checking if the padding property has been applied... OK\r\n\r\n      Question 2.13 [1 point] - Validating list property:\r\n         Checking if the list property has been created... OK\r\n         Checking if the list property has been applied... OK\r\n\r\n      Question 2.14 [1 point] - Validating (top | right | bottom | left) property:\r\n         Checking if the (top | right | bottom | left) property has been created... OK\r\n         Checking if the (top | right | bottom | left) property has been applied... OK\r\n\r\n   TOTAL SCORE: 9.41 / 10\r\n\r\nRunning script DAM - M04 (UF1): CSS3 Assignment (v1.0.0.2):\r\nRunning on batch mode for Student Name 2:\r\n   Question 1 [3 points] - Checking index.html:\r\n      Looking for index.html... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 1.1 [1 point] - Validating inline CSS:\r\n         Checking for inline CSS entries... OK\r\n\r\n      Question 1.2 [1 point] - Validating DIVs:\r\n         Checking the amount of divs... OK\r\n\r\n      Question 1.3 [1 point] - Validating video:\r\n         Checking amount of video entries... OK\r\n\r\n   Question 2 [14 points] - Checking index.css:\r\n      Looking for index.css... OK\r\n      Loading index.css... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... OK\r\n\r\n      Question 2.1 [1 point] - Validating font property:\r\n         Checking if the font property has been created... OK\r\n         Checking if the font property has been applied... OK\r\n\r\n      Question 2.2 [1 point] - Validating border property:\r\n         Checking if the border property has been created... OK\r\n         Checking if the border property has been applied... OK\r\n\r\n      Question 2.3 [1 point] - Validating text property:\r\n         Checking if the text property has been created... OK\r\n         Checking if the text property has been applied... OK\r\n\r\n      Question 2.4 [1 point] - Validating color property:\r\n         Checking if the color property has been created... OK\r\n         Checking if the color property has been applied... OK\r\n\r\n      Question 2.5 [1 point] - Validating background property:\r\n         Checking if the background property has been created... OK\r\n         Checking if the background property has been applied... OK\r\n\r\n      Question 2.6 [1 point] - Validating position:absolute property:\r\n         Checking if the position:absolute property has been created... OK\r\n         Checking if the position:absolute property has been applied... OK\r\n\r\n      Question 2.7 [1 point] - Validating position:relative property:\r\n         Checking if the position:relative property has been created... OK\r\n         Checking if the position:relative property has been applied... OK\r\n\r\n      Question 2.8 [1 point] - Validating clear property:\r\n         Checking if the clear property has been created... OK\r\n         Checking if the clear property has been applied... OK\r\n\r\n      Question 2.9 [1 point] - Validating clear property:\r\n         Checking if the width property has been created... OK\r\n         Checking if the width property has been applied... OK\r\n\r\n      Question 2.10 [1 point] - Validating height property:\r\n         Checking if the height property has been created... OK\r\n         Checking if the height property has been applied... OK\r\n\r\n      Question 2.11 [1 point] - Validating margin property:\r\n         Checking if the margin property has been created... OK\r\n         Checking if the margin property has been applied... OK\r\n\r\n      Question 2.12 [1 point] - Validating padding property:\r\n         Checking if the padding property has been created... OK\r\n         Checking if the padding property has been applied... OK\r\n\r\n      Question 2.13 [1 point] - Validating list property:\r\n         Checking if the list property has been created... OK\r\n         Checking if the list property has been applied... OK\r\n\r\n      Question 2.14 [1 point] - Validating (top | right | bottom | left) property:\r\n         Checking if the (top | right | bottom | left) property has been created... OK\r\n         Checking if the (top | right | bottom | left) property has been applied... OK\r\n\r\n   TOTAL SCORE: 10 / 10\r\n\r\nRunning script DAM - M04 (UF1): CSS3 Assignment (v1.0.0.2):\r\nRunning on batch mode for Student Name 3:\r\n   Question 1 [3 points] - Checking index.html:\r\n      Looking for index.html... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... ERROR:\n         -Element head is missing a required instance of child element title.tyle>\n             <h1>La MusContent model for element head:If the document is an iframesrcdoc document or if title information is available from a higher-level protocol: Zero or more elements of metadata content, of which no more than one is a title element and no more than one is a base element.Otherwise: One or more elements of metadata content, of which exactly one is a title element and no more than one is a base element.\r\n\r\n   Question 2 [14 points] - Checking index.css:\r\n      Looking for index.css... OK\r\n      Loading index.css... OK\r\n      Loading index.html... OK\r\n      Validating document against the W3C validation service... ERROR:\n         -Value Error :  padding (nullbox.html#propdef-padding)\n         “,” is an incorrect operator :\r\n\r\n   TOTAL SCORE: 0 / 10";
            Assert.AreEqual(expected, s.Output.ToString());
        }
    }
}